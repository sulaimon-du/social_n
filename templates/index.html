{# index.html #}
{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è{% endblock title %}

{% block content %}
  <!-- –°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ -->
  <div class="grid gap-6">
    {% for post in posts %}
    <div class="bg-white p-4 rounded shadow-md max-w-3xl">
      {% if profile_photos %}<img src="{{ url_for('serve_profile_photo', filename=profile_photos[post.user_id].name)}}" width="100" alt="–§–æ—Ç–æ –ü—Ä–æ—Ñ–∏–ª—è"> {% endif %}
      <div class="text-sm text-gray-500 mb-3">{{ post.username }} ‚Ä¢ {{ post.created_at }}</div>
      {% if post.id in image_paths %}
      <img src="{{ url_for('serve_post_image', filename=image_paths[post.id].name) }}" width="400" alt="–§–æ—Ç–æ –ø–æ—Å—Ç–∞">
      {% endif %}
      <a href="{{ url_for('get_post', post_id=post.id)}}">
      <h2 class="text-xl font-semibold mb-2">{{ post.title }}</h2>
      <p class="text-gray-700 mb-3">{{ post.content }}</p>
      </a>
      {% if post.id in likes_data %}
        {% set likes = likes_data[post.id] %}
        <form action="{{url_for('like_post', post_id=post.id)}}" method="post">
            <input type="hidden" name="is_liked" value="{{likes.is_liked}}">
            <input type="hidden" name="next" value="True">
            {% if session['user_id']  %}
            <button type="submit" class="rounded-full p-2 text-2xl hover:scale-125 transition-all duration-200 focus:outline-none">
            {% if likes.is_liked %} ‚ù§Ô∏è {% else %} ü§ç {% endif %}
            </button> 
            {% endif %} 
          </form>
          {% if likes.likes > 1 %} {{likes.likes}} –æ—Ç–º–µ—Ç–æ–∫ "–ù—Ä–∞–≤–∏—Ç—Å—è"
          {% elif likes.likes == 1 %} {{likes.likes}} –æ—Ç–º–µ—Ç–∫–∞ "–ù—Ä–∞–≤–∏—Ç—Å—è"
          {% endif %}
      {% endif %}
    </div>
        

    {% endfor %}
  </div>

  <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
  <div class="mt-6 text-center">
    <form method="post">
      <input type="hidden" name="scroll_to" value="post-{{ posts|length }}">
      <button type="submit" name="more"
        class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
        –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë
      </button>
    </form>
  </div>
{% endblock content %}
