{# profile.html #}
{% extends "base.html" %}
{% block title %}–ü—Ä–æ—Ñ–∏–ª—å{% endblock title %}

{% block content %}
<h2 class="text-2xl font-semibold mb-4">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
{% if not profile_photo %}
<form method="POST" action="{{ url_for('profile') }}" enctype="multipart/form-data">
  <input type="file" name="file" accept="image/*"><br>
  <button type="submit">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è</button>
</form><br>
{% else %}
<img src="{{ url_for('serve_profile_photo', filename=profile_photo.name)}}" width="200" alt="–§–æ—Ç–æ –ü—Ä–æ—Ñ–∏–ª—è">
<form method="POST" action="{{ url_for('profile') }}" enctype="multipart/form-data">
  <input type="file" name="file" accept="image/*"><br>
  <button type="submit">–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ</button>
</form><br>
{% endif %}


<p>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ session['username'] }}</p>
<p>Email: {{ session['email'] }}</p><br>

<h2 class="text-xl font-semibold mb-2"> –ú–æ–∏ –ü–æ—Å—Ç—ã:</h2>
<div class="grid gap-6">
    {% for post in posts %}
      {% if session['username'] in post.username %}
        <div class="bg-white p-4 rounded shadow-md max-w-3xl">
        <div class="text-sm text-gray-500 mb-3">{{ post.username }} ‚Ä¢ {{ post.created_at }}</div>
        {% if post.id in image_paths %}
          <img src="{{ url_for('serve_post_image', filename=image_paths[post.id].name) }}" width="400" alt="–§–æ—Ç–æ –ø–æ—Å—Ç–∞">
        {% endif %}
        <a href="{{ url_for('get_post', post_id=post.id)}}">
        <h2 class="text-xl font-semibold mb-2">{{ post.title }}</h2>
        <p class="text-gray-700 mb-3">{{ post.content }}</p>
        </a>
        {% if post.id in likes_data %}
            {% set likes = likes_data[post.id] %}
            <form action="{{url_for('like_post', post_id=post.id)}}" method="post">
                <input type="hidden" name="is_liked" value="{{likes.is_liked}}">
                <button type="submit" class="rounded-full p-2 text-2xl hover:scale-125 transition-all duration-200 focus:outline-none">
                {% if likes.is_liked %} ‚ù§Ô∏è {% else %} ü§ç {% endif %}
                </button>
            </form>
            {% if likes.likes > 1 %} {{likes.likes}} –æ—Ç–º–µ—Ç–æ–∫ "–ù—Ä–∞–≤–∏—Ç—Å—è"
            {% elif likes.likes == 1 %} {{likes.likes}} –æ—Ç–º–µ—Ç–∫–∞ "–ù—Ä–∞–≤–∏—Ç—Å—è"
          {% endif %}
        {% endif %}
        </div>
      {% endif %}
    
        

    {% endfor %}
  </div>

{% endblock content %}
